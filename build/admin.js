!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.SchnackAdmin=n()}(this,function(){"use strict";var t="function"==typeof fetch?fetch.bind():function(o,r){return r=r||{},new Promise(function(e,n){var t=new XMLHttpRequest;for(var s in t.open(r.method||"get",o,!0),r.headers)t.setRequestHeader(s,r.headers[s]);function u(){var s,o=[],r=[],i={};return t.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,n,t){o.push(n=n.toLowerCase()),r.push([n,t]),s=i[n],i[n]=s?s+","+t:t}),{ok:2==(t.status/100|0),status:t.status,statusText:t.statusText,url:t.responseURL,clone:u,text:function(){return Promise.resolve(t.responseText)},json:function(){return Promise.resolve(t.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([t.response]))},headers:{keys:function(){return o},entries:function(){return r},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}}t.withCredentials="include"==r.credentials,t.onload=function(){e(u())},t.onerror=n,t.send(r.body||null)})};var e=function(e){this.options=e,this.options.endpoint=e.host+"/get_newer",this.initialized=!1,this.firstLoad=!0;var n=new URL(e.host);if("localhost"!==n.hostname)try{document.domain=n.hostname.split(".").slice(1).join(".")}catch(e){}this.refresh()};return e.prototype.refresh=function(){var e=this.options,r=e.target,n=e.endpoint;t(n,{credentials:"include",headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){var n,t,s,o;(o=r,document.querySelector(o)).innerHTML=(s="",(n=e).user&&(s+='\n<div class="schnack-login-status">\n  (已登录为 <span class="schnack-user">'+(null==(t=n.user.name)?"":t)+"</span>)\n</div>\n"),s+='\n</div>\n\n<ul class="schnack-comments">\n  ',n.comments.forEach(function(e){s+="\n    <li>\n      ",0===e.slug.indexOf("userguide3/")?s+='\n        <a href="https://codeigniter.org.cn/'+(null==(t=e.slug.replace("userguide3/","user_guide/"))?"":t)+'.html" target="_blank">'+(null==(t=e.slug)?"":t)+"</a>: "+(null==(t=e.count)?"":t)+"\n      ":s+="\n        "+(null==(t=e.slug)?"":t)+": "+(null==(t=e.count)?"":t)+"\n      ",s+="\n    </li>\n  "}),s+="\n</ul>\n")})},e});
